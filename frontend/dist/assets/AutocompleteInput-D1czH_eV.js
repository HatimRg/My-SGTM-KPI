import{j as r}from"./index-B_O7GBLG.js";import{r as s}from"./vendor-react-Bagy_njL.js";import{i as I,C as R}from"./vendor-ui-ByylQ01J.js";function H({value:m="",onChange:p,suggestions:l=[],placeholder:S="",defaultValue:i="",required:C=!1,className:E="",disabled:x=!1,icon:g=null}){const[a,d]=s.useState(m),[h,o]=s.useState(!1),[n,v]=s.useState([]),[f,y]=s.useState(-1),b=s.useRef(null),w=s.useRef(null);s.useEffect(()=>{d(m)},[m]),s.useEffect(()=>{if(!a.trim())v(l.slice(0,10));else{const e=a.toLowerCase(),t=l.filter(c=>c.toLowerCase().includes(e)).sort((c,u)=>{const k=c.toLowerCase().startsWith(e),N=u.toLowerCase().startsWith(e);return k&&!N?-1:!k&&N?1:c.localeCompare(u)}).slice(0,10);v(t)}y(-1)},[a,l]),s.useEffect(()=>{const e=t=>{w.current&&!w.current.contains(t.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);const D=e=>{const t=e.target.value;d(t),p(t),o(!0)},j=e=>{d(e),p(e),o(!1),b.current?.focus()},$=e=>{if(!h||n.length===0){e.key==="ArrowDown"&&o(!0);return}switch(e.key){case"ArrowDown":e.preventDefault(),y(t=>t<n.length-1?t+1:t);break;case"ArrowUp":e.preventDefault(),y(t=>t>0?t-1:-1);break;case"Enter":e.preventDefault(),f>=0&&n[f]&&j(n[f]);break;case"Escape":o(!1);break;case"Tab":o(!1);break}},A=()=>{o(!0)},L=()=>{d(""),p(""),b.current?.focus()};return i&&!l.includes(i)&&[...l],r.jsxs("div",{ref:w,className:"relative",children:[r.jsxs("div",{className:"relative",children:[g&&r.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:g}),r.jsx("input",{ref:b,type:"text",value:a,onChange:D,onKeyDown:$,onFocus:A,placeholder:S,required:C,disabled:x,className:`input ${g?"pl-10":""} ${a&&!x?"pr-16":"pr-8"} ${E}`}),r.jsxs("div",{className:"absolute right-2 top-1/2 -translate-y-1/2 flex items-center gap-1",children:[a&&!x&&r.jsx("button",{type:"button",onClick:L,className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:r.jsx(I,{className:"w-3.5 h-3.5 text-gray-400"})}),r.jsx(R,{className:`w-4 h-4 text-gray-400 transition-transform ${h?"rotate-180":""}`})]})]}),h&&n.length>0&&r.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:n.map((e,t)=>{const c=t===f,u=e===i;return r.jsxs("button",{type:"button",onClick:()=>j(e),className:`w-full px-3 py-2 text-left text-sm flex items-center justify-between
                  ${c?"bg-hse-primary/10 text-hse-primary":"text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700"}
                  ${t===0?"rounded-t-lg":""}
                  ${t===n.length-1?"rounded-b-lg":""}
                `,children:[r.jsx("span",{className:u?"font-medium":"",children:e}),u&&r.jsx("span",{className:"text-xs px-1.5 py-0.5 bg-hse-primary/10 text-hse-primary rounded",children:"défaut"})]},e)})}),h&&a&&n.length===0&&r.jsxs("div",{className:"absolute z-50 w-full mt-1 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg p-3",children:[r.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:["Nouvelle valeur: ",r.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-200",children:a})]}),r.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Appuyez sur Entrée ou cliquez ailleurs pour confirmer"})]})]})}export{H as A};
