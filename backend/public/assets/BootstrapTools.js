import{u as R,j as e,v as j}from"./index.js";import{r as s}from"./vendor-react.js";import"./vendor-ui.js";import"./vendor-utils.js";function O(){const{user:p,isAuthenticated:u}=R(),[m,N]=s.useState(null),[x,v]=s.useState(!0),[i,w]=s.useState(""),[c,D]=s.useState(""),[h,b]=s.useState(!1),[g,a]=s.useState(null),[y,o]=s.useState(null),S=s.useMemo(()=>u&&p?.email==="rsp@test.com",[u,p]),f=async(t,l,C=void 0)=>{o(null),a(null);try{const r=await j.get(t,{responseType:"blob",params:C,timeout:3e5}),d=window.URL.createObjectURL(r.data),n=document.createElement("a");n.href=d,n.download=l,document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(d)}catch(r){const d=r?.response?.data?.message||r?.message||"Download failed";o(d),a(r?.response?.data||null)}},U=async()=>{if(!m){o("Please select a JSON file first.");return}b(!0),o(null),a(null);try{const t=new FormData;t.append("file",m),t.append("dry_run",x?"1":"0");const l=await j.post("/bootstrap/import",t,{headers:{"Content-Type":"multipart/form-data"},timeout:3e5});a(l.data)}catch(t){const l=t?.response?.data?.message||t?.message||"Upload failed";o(l),a(t?.response?.data||null)}finally{b(!1)}};return S?e.jsxs("div",{className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"Bootstrap Tools"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Accessible only for rsp@test.com"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("button",{className:"px-4 py-2 rounded bg-gray-900 text-white",onClick:()=>f("/bootstrap/template","bootstrap-template.json"),type:"button",children:"Download Template"}),e.jsx("button",{className:"px-4 py-2 rounded bg-gray-700 text-white",onClick:()=>f("/bootstrap/export","bootstrap-export.json",{...i?{from:i}:{},...c?{to:c}:{}}),type:"button",children:"Export Current Data"})]}),e.jsxs("div",{className:"border rounded p-4 space-y-3",children:[e.jsx("div",{className:"font-medium",children:"Export Filters (optional)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("label",{className:"text-sm",children:["From",e.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",type:"date",value:i,onChange:t=>w(t.target.value)})]}),e.jsxs("label",{className:"text-sm",children:["To",e.jsx("input",{className:"mt-1 w-full border rounded px-2 py-1",type:"date",value:c,onChange:t=>D(t.target.value)})]})]}),e.jsx("div",{className:"text-xs text-gray-600",children:"For large datasets, export only the date range you need (e.g., last 2 months)."})]}),e.jsxs("div",{className:"border rounded p-4 space-y-3",children:[e.jsx("div",{className:"font-medium",children:"Import JSON"}),e.jsx("input",{type:"file",accept:"application/json,.json,text/plain,.txt",onChange:t=>N(t.target.files?.[0]||null)}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx("input",{type:"checkbox",checked:x,onChange:t=>v(t.target.checked)}),"Dry-run (validate + simulate, no DB writes)"]}),e.jsx("button",{className:"px-4 py-2 rounded bg-blue-600 text-white disabled:opacity-50",onClick:U,disabled:h,type:"button",children:h?"Uploading...":"Upload & Import"}),y?e.jsx("div",{className:"text-sm text-red-600",children:y}):null,g?e.jsx("pre",{className:"text-xs bg-gray-50 border rounded p-3 overflow-auto",children:JSON.stringify(g,null,2)}):null]})]}):e.jsx("div",{className:"p-6",children:e.jsx("h1",{className:"text-xl font-semibold",children:"Not Found"})})}export{O as default};
