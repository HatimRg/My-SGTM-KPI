import{c as g}from"./vendor-utils.js";import{u as j,h as A,D as r,p}from"./index.js";const v=g((e,n)=>({projects:[],isLoading:!1,hasLoaded:!1,error:null,lastScope:null,fetchProjects:async(a,u={})=>{const{isLoading:S,hasLoaded:f,projects:c}=n(),t=j.getState?.()?.user?.role==="dev",h=t?A.getState?.()?.projectScope:null,l=t&&h===r.ASSIGNED?r.ASSIGNED:r.ALL,{lastScope:i}=n(),L=t&&i&&i!==l;if(!u.force&&!L&&f&&c.length>0||S)return c;const s={...a||{}};t&&(l===r.ASSIGNED&&(s.scope="assigned"),e({lastScope:l})),e({isLoading:!0,error:null});try{if(Object.prototype.hasOwnProperty.call(s,"page")){const d=(await p.getAll(s)).data?.data??[];return e({projects:d,isLoading:!1,hasLoaded:!0}),d}const o=await p.getAllList(s);return e({projects:o,isLoading:!1,hasLoaded:!0}),o}catch(o){throw console.error("Failed to load projects:",o),e({error:o,isLoading:!1}),o}},setProjects:a=>e({projects:a}),reset:()=>e({projects:[],hasLoaded:!1,error:null,lastScope:null})}));export{v as u};
