import{a as p,j as t}from"./index.js";import{r as l}from"./vendor-react.js";import{q as x,X as k}from"./vendor-ui.js";function w(i){const r=["admin","hse_manager","dev","pole_director","works_director","hse_director","hr_director"].includes(i);return{minLength:r?12:8,requireLower:!0,requireUpper:!0,requireDigit:!0,requireSpecial:r,hintKey:r?"auth.passwordPolicy.privileged":"auth.passwordPolicy.standard"}}function u(i,n){const r=String(i??""),e={minLength:r.length>=(n?.minLength??0),lower:/[a-z]/.test(r),upper:/[A-Z]/.test(r),digit:/\d/.test(r),special:n?.requireSpecial?/[^A-Za-z0-9]/.test(r):!0};return{ok:e.minLength&&e.lower&&e.upper&&e.digit&&e.special,checks:e}}function y(i,n){const r=String(i??"");if(!r)return{score:0,max:5};const{checks:e}=u(r,{...n??{minLength:8,requireLower:!0,requireUpper:!0,requireDigit:!0,requireSpecial:!1}}),s=n?.requireSpecial?5:4,c=[e.minLength,e.lower,e.upper,e.digit].filter(Boolean).length,a=n?.requireSpecial&&e.special?1:0;return{score:Math.min(s,c+a),max:s}}function j({password:i,role:n,policy:r}){const{t:e}=p(),s=l.useMemo(()=>r||w(n),[r,n]),c=l.useMemo(()=>u(i,s),[i,s]),a=l.useMemo(()=>y(i,s),[i,s]),d=a.max>0?Math.round(a.score/a.max*100):0,h=a.score<=1?"auth.passwordStrength.weak":a.score===2?"auth.passwordStrength.fair":a.score===3?"auth.passwordStrength.good":"auth.passwordStrength.strong",m=a.score<=1?"bg-red-500":a.score===2?"bg-amber-500":a.score===3?"bg-blue-500":"bg-green-500",g=[{key:"minLength",ok:c.checks.minLength,label:e("auth.passwordRequirements.minLength",{min:s.minLength})},{key:"lower",ok:c.checks.lower,label:e("auth.passwordRequirements.lowercase")},{key:"upper",ok:c.checks.upper,label:e("auth.passwordRequirements.uppercase")},{key:"digit",ok:c.checks.digit,label:e("auth.passwordRequirements.digit")}];return s.requireSpecial&&g.push({key:"special",ok:c.checks.special,label:e("auth.passwordRequirements.special")}),t.jsxs("div",{className:"rounded-xl border border-gray-200 dark:border-gray-700 bg-gray-50 dark:bg-gray-900/40 p-4",children:[t.jsxs("div",{className:"flex items-start justify-between gap-3",children:[t.jsxs("div",{className:"min-w-0",children:[t.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:e("auth.passwordStrength.title")}),t.jsx("div",{className:"text-xs text-gray-600 dark:text-gray-400 mt-0.5",children:e(s.hintKey)})]}),t.jsx("div",{className:"text-xs font-semibold text-gray-700 dark:text-gray-200 whitespace-nowrap",children:e(h)})]}),t.jsx("div",{className:"mt-3 h-2 w-full rounded-full bg-gray-200 dark:bg-gray-800 overflow-hidden",children:t.jsx("div",{className:`h-full ${m}`,style:{width:`${d}%`}})}),t.jsx("div",{className:"mt-3 grid grid-cols-1 sm:grid-cols-2 gap-2",children:g.map(o=>t.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[o.ok?t.jsx(x,{className:"w-4 h-4 text-green-600"}):t.jsx(k,{className:"w-4 h-4 text-gray-400"}),t.jsx("span",{className:o.ok?"text-gray-800 dark:text-gray-200":"text-gray-600 dark:text-gray-400",children:o.label})]},o.key))})]})}export{j as P,u as c,w as g};
