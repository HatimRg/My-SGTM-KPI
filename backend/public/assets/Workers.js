import{a as dt,u as mt,p as pe,w as m,j as e}from"./index.js";import{r as a}from"./vendor-react.js";import{D as he}from"./DatePicker.js";import{C as ge}from"./ConfirmDialog.js";import{M as ue}from"./Modal.js";import{S as P}from"./Select.js";import{A as je}from"./AutocompleteInput.js";import{s as xt,g as fe}from"./projectList.js";import{z as o,a5 as V,a8 as pt,ah as ht,aw as gt,U as Y,h as G,o as ut,aa as jt,af as ye,s as J,ax as ft,az as yt,B as bt,i as kt}from"./vendor-ui.js";import"./vendor-utils.js";function Tt(){const{t:s}=dt(),{user:be}=mt(),X=a.useRef(null),[g,ke]=a.useState([]),[k,ve]=a.useState([]),[K,Ne]=a.useState([]),[Q,we]=a.useState([]),[j,Se]=a.useState(null),[Ce,Z]=a.useState(!0),[B,f]=a.useState(1),[vt,_e]=a.useState(1),[I,De]=a.useState(0),[We]=a.useState(50),[v,Pe]=a.useState(""),[N,Ae]=a.useState(""),[x,Fe]=a.useState(""),[i,$]=a.useState(""),[p,Ee]=a.useState(""),[h,Te]=a.useState(""),[Le,ee]=a.useState([]),te=be?.project_list_preference??"code",A=a.useMemo(()=>xt(k,te),[k,te]),Me=a.useMemo(()=>{const t=Array.isArray(A)?A:[];return x?t.filter(r=>r?.pole===x):t},[A,x]),[u,F]=a.useState([]),[E,se]=a.useState(!1),[Ue,ae]=a.useState(!1),[Re,T]=a.useState(!1),[w,O]=a.useState(null),[re,ne]=a.useState(!1),[le,ce]=a.useState(!1),[S,L]=a.useState(null),[y,H]=a.useState(null),[Be,M]=a.useState(!1),[l,d]=a.useState({nom:"",prenom:"",fonction:"",cin:"",date_naissance:"",entreprise:"",project_id:"",date_entree:"",is_active:!0});a.useEffect(()=>{C()},[]),a.useEffect(()=>{_()},[B,N,i,p,h,x]),a.useEffect(()=>{(async()=>{try{const r=await pe.getPoles(),n=r.data?.data?.poles??r.data?.poles??[];ee(Array.isArray(n)?n:[])}catch{ee([])}})()},[]),a.useEffect(()=>{if(!x)return;!k.some(r=>String(r.id)===String(i)&&r?.pole===x)&&i&&$("")},[x,i,k]),a.useEffect(()=>{const t=setTimeout(()=>{Ae(v)},300);return()=>clearTimeout(t)},[v]);const C=async()=>{try{const[t,r,n,c]=await Promise.all([pe.getAllList({status:"active"}),m.getEntreprises(),m.getFonctions(),m.getStatistics()]);ve(Array.isArray(t)?t:[]),Ne(r.data.data??[]),we(n.data.data??[]),Se(c.data.data)}catch(t){console.error("Failed to load initial data:",t)}},_=async()=>{try{Z(!0);const t={page:B,per_page:We,search:N||void 0,pole:x||void 0,project_id:i||void 0,entreprise:p||void 0,fonction:h||void 0,is_active:!0},n=(await m.getAll(t)).data,c=n.data??n,b=Array.isArray(c)?c:c?.data??[],U=n.meta??c.meta??c;ke(R=>B===1?b:[...R,...b]),_e(U.last_page??1),De(U.total??b.length)}catch{o.error(s("errors.somethingWentWrong"))}finally{Z(!1)}},Ie=j?.hse_team??g.filter(t=>t.fonction?.toLowerCase().includes("hse")).length,$e=j?.induction_hse??0,Oe=j?.travail_en_hauteur??0,He=j?.aptitude_physique??0,oe=(t=null)=>{t?(O(t),d({nom:t.nom??"",prenom:t.prenom??"",fonction:t.fonction??"",cin:t.cin?.toUpperCase()??"",date_naissance:t.date_naissance?.split("T")[0]??"",entreprise:t.entreprise??"",project_id:t.project_id??"",date_entree:t.date_entree?.split("T")[0]??"",is_active:t.is_active??!0})):(O(null),d({nom:"",prenom:"",fonction:"",cin:"",date_naissance:"",entreprise:"",project_id:"",date_entree:"",is_active:!0})),ae(!0)},z=()=>{ae(!1),O(null)},ze=async t=>{t.preventDefault(),ne(!0);const r={...l,cin:l.cin?.toUpperCase()};try{w?(await m.update(w.id,r),o.success(s("workers.updated"))):(await m.create(r)).data.data?.merged?o.success(s("workers.merged")):o.success(s("workers.created")),z(),_(),C()}catch(n){o.error(n.response?.data?.message??s("errors.somethingWentWrong"))}finally{ne(!1)}},qe=t=>{H(t)},Ve=async()=>{if(y)try{await m.delete(y.id),o.success(s("workers.deactivated")),_(),C()}catch{o.error(s("errors.somethingWentWrong"))}finally{H(null)}},Ye=()=>{u.length!==0&&M(!0)},Ge=async()=>{if(u.length===0){M(!1);return}try{const t=await m.bulkDeactivate(u);o.success(s("workers.bulkDeactivated",{count:t.data.data.deactivated_count})),F([]),se(!1),_(),C()}catch{o.error(s("errors.somethingWentWrong"))}finally{M(!1)}},ie=async()=>{try{const t=await m.downloadTemplate(),r=window.URL.createObjectURL(new Blob([t.data])),n=document.createElement("a");n.href=r,n.setAttribute("download","workers_template.xlsx"),document.body.appendChild(n),n.click(),n.remove()}catch{o.error(s("errors.somethingWentWrong"))}},Je=async()=>{try{const r={project_id:i||void 0,entreprise:p||void 0,fonction:h||void 0,is_active:!0,search:N||v||void 0},n=await m.export(r),c=n.data instanceof Blob?n.data:new Blob([n.data]),b=window.URL.createObjectURL(c),R=(n.headers?.["content-disposition"]??n.headers?.["Content-Disposition"])?.match(/filename\*=UTF-8''([^;]+)|filename="?([^";]+)"?/i),me=R?.[1]??R?.[2],Ze=me?decodeURIComponent(me):null,D=[];if(i){const xe=k.find(it=>String(it.id)===String(i))?.name;xe&&D.push(xe)}p&&D.push(p),h&&D.push(h);const et=D.length?D.join(", "):"active",q=new Date,tt=String(q.getDate()).padStart(2,"0"),st=String(q.getMonth()+1).padStart(2,"0"),at=String(q.getFullYear()),rt=`${tt}-${st}-${at}`,nt=et.replace(/[\\/:*?"<>|]/g,"-").replace(/\s+/g," ").trim(),lt=(c.type?.includes("csv")?!0:!!c.type?.includes("text/plain"))?"csv":"xlsx",ct=`Workers_export_(${nt})_date(${rt}).${lt}`,ot=Ze??ct,W=document.createElement("a");W.href=b,W.setAttribute("download",ot),document.body.appendChild(W),W.click(),W.remove(),o.success(s("common.exportSuccess"))}catch(t){try{const r=t?.response?.data;if(r instanceof Blob&&r.type?.includes("application/json")){const n=await r.text(),c=JSON.parse(n);o.error(c?.message??s("errors.somethingWentWrong"));return}}catch{}o.error(t.response?.data?.message??s("errors.somethingWentWrong"))}},Xe=async()=>{if(S){ce(!0);try{const t=new FormData;t.append("file",S),i&&t.append("project_id",i);const r=await m.import(t);o.success(s("workers.importSuccess",{imported:r.data.data.imported_count,merged:r.data.data.merged_count})),T(!1),L(null),_(),C()}catch(t){o.error(t.response?.data?.message??s("errors.somethingWentWrong"))}finally{ce(!1)}}},Ke=t=>{F(r=>r.includes(t)?r.filter(n=>n!==t):[...r,t])},de=()=>{F(E?[]:g.map(t=>t.id)),se(!E)},Qe=t=>t?new Date(t).toLocaleDateString("fr-FR"):"-";return e.jsxs("div",{className:"space-y-6 animate-fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:s("workers.title")}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:s("workers.subtitle")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:ie,className:"btn-outline btn-sm flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),s("workers.downloadTemplate")]}),e.jsxs("button",{onClick:()=>T(!0),className:"btn-outline btn-sm flex items-center gap-2",children:[e.jsx(pt,{className:"w-4 h-4"}),s("workers.import")]}),e.jsxs("button",{onClick:Je,className:"btn-outline btn-sm flex items-center gap-2",children:[e.jsx(ht,{className:"w-4 h-4"}),s("workers.export")]}),e.jsxs("button",{onClick:()=>oe(),className:"btn-primary btn-sm flex items-center gap-2",children:[e.jsx(gt,{className:"w-4 h-4"}),s("workers.addWorker")]})]})]}),j&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-blue-100 dark:bg-blue-900/50 rounded-lg",children:e.jsx(Y,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("workers.totalWorkers")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:j.active})]})]}),e.jsxs("div",{className:"card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-orange-100 dark:bg-orange-900/50 rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-orange-600 dark:text-orange-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("workers.hseTeam")}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:Ie})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-emerald-100 dark:bg-emerald-900/50 rounded-lg",children:e.jsx(ut,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Induction HSE"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:$e})]})]}),e.jsxs("div",{className:"card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-purple-100 dark:bg-purple-900/50 rounded-lg",children:e.jsx(G,{className:"w-5 h-5 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Work at height"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:Oe})]})]}),e.jsxs("div",{className:"card p-3 flex items-center gap-3",children:[e.jsx("div",{className:"p-2.5 bg-amber-100 dark:bg-amber-900/50 rounded-lg",children:e.jsx(Y,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Physical aptitude"}),e.jsx("p",{className:"text-xl font-bold text-gray-900 dark:text-white",children:He})]})]})]})]}),e.jsx("div",{className:"card p-3",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[e.jsxs("div",{className:"relative md:col-span-3",children:[e.jsx(jt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:v,onChange:t=>{Pe(t.target.value),f(1)},placeholder:s("common.search"),className:"input pl-9 py-1.5 text-sm"})]}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(P,{value:x,onChange:t=>{Fe(t.target.value),$(""),f(1)},className:"py-1.5 text-sm",children:[e.jsx("option",{value:"",children:s("common.allPoles")}),Le.map(t=>e.jsx("option",{value:t,children:t},t))]})}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs(P,{value:i,onChange:t=>{$(t.target.value),f(1)},className:"py-1.5 text-sm",children:[e.jsx("option",{value:"",children:s("workers.allProjects")}),Me.map(t=>e.jsx("option",{value:t.id,children:fe(t)},t.id))]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(P,{value:p,onChange:t=>{Ee(t.target.value),f(1)},className:"py-1.5 text-sm",children:[e.jsx("option",{value:"",children:s("workers.allEntreprises")}),K.map(t=>e.jsx("option",{value:t,children:t},t))]})}),e.jsx("div",{className:"md:col-span-2",children:e.jsxs(P,{value:h,onChange:t=>{Te(t.target.value),f(1)},className:"py-1.5 text-sm",children:[e.jsx("option",{value:"",children:s("workers.allFonctions")}),Q.map(t=>e.jsx("option",{value:t,children:t},t))]})})]})}),u.length>0&&e.jsxs("div",{className:"card p-2.5 flex items-center justify-between bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:de,className:"rounded border-red-300 text-red-600 focus:ring-red-500"}),e.jsxs("span",{className:"text-sm font-medium text-red-700 dark:text-red-300",children:[u.length," ",s("common.selected")]})]}),e.jsxs("button",{onClick:Ye,className:"btn-danger btn-sm flex items-center gap-1.5 text-xs",children:[e.jsx(ye,{className:"w-3.5 h-3.5"}),s("workers.bulkDeactivate")]})]}),e.jsxs("div",{className:"card overflow-hidden",children:[Ce?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(J,{className:"w-6 h-6 animate-spin text-hse-primary"})}):g.length>0?e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-50 dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700",children:[e.jsx("th",{className:"w-8 px-2 py-2",children:e.jsx("input",{type:"checkbox",checked:E,onChange:de,className:"w-3.5 h-3.5 rounded border-gray-300 dark:border-gray-600 text-hse-primary focus:ring-hse-primary"})}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.nom")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.prenom")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.cin")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.fonction")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.entreprise")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.projet")}),e.jsx("th",{className:"px-2 py-2 text-left font-semibold text-gray-700 dark:text-gray-300",children:s("workers.dateEntree")}),e.jsx("th",{className:"px-2 py-2 text-center font-semibold text-gray-700 dark:text-gray-300 w-16",children:s("common.actions")})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100 dark:divide-gray-700",children:g.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-800/50",children:[e.jsx("td",{className:"px-2 py-1.5",children:e.jsx("input",{type:"checkbox",checked:u.includes(t.id),onChange:()=>Ke(t.id),className:"w-3.5 h-3.5 rounded border-gray-300 dark:border-gray-600 text-hse-primary focus:ring-hse-primary"})}),e.jsx("td",{className:"px-2 py-1.5 font-medium text-gray-900 dark:text-white",children:t.nom}),e.jsx("td",{className:"px-2 py-1.5 text-gray-700 dark:text-gray-300",children:t.prenom}),e.jsx("td",{className:"px-2 py-1.5 font-mono text-gray-600 dark:text-gray-400",children:t.cin?.toUpperCase()}),e.jsx("td",{className:"px-2 py-1.5 text-gray-700 dark:text-gray-300",children:t.fonction??""}),e.jsx("td",{className:"px-2 py-1.5 text-gray-700 dark:text-gray-300",children:t.entreprise??""}),e.jsx("td",{className:"px-2 py-1.5 text-gray-700 dark:text-gray-300",children:t.project?.name??""}),e.jsx("td",{className:"px-2 py-1.5 text-gray-600 dark:text-gray-400",children:Qe(t.date_entree)}),e.jsx("td",{className:"px-2 py-1.5",children:e.jsxs("div",{className:"flex items-center justify-center gap-0.5",children:[e.jsx("button",{onClick:()=>oe(t),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",title:s("common.edit"),children:e.jsx(ft,{className:"w-3.5 h-3.5 text-gray-500 dark:text-gray-400"})}),e.jsx("button",{onClick:()=>qe(t),className:"p-1 hover:bg-red-100 dark:hover:bg-red-900/30 rounded",title:s("workers.deactivate"),children:e.jsx(ye,{className:"w-3.5 h-3.5 text-red-500 dark:text-red-400"})})]})})]},t.id))})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:[e.jsx(Y,{className:"w-10 h-10 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-sm",children:s("workers.noWorkers")})]}),(g.length>0?!0:I>0)&&e.jsxs("div",{className:"px-3 py-2 border-t border-gray-200 dark:border-gray-700 flex items-center justify-between bg-gray-50 dark:bg-gray-800/50",children:[e.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:[s("pagination.showing")," ",g.length," ",s("pagination.of")," ",I," ",s("pagination.results")]}),g.length<I&&e.jsx("button",{onClick:()=>f(t=>t+1),className:"px-2 py-1 text-xs rounded border border-gray-300 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-700 text-gray-700 dark:text-gray-300",children:s("common.showMore")})]})]}),e.jsx(ue,{isOpen:Ue,onClose:z,title:s(w?"workers.editWorker":"workers.newWorker"),size:"lg",children:e.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:[s("workers.nom")," *"]}),e.jsx("input",{type:"text",value:l.nom,onChange:t=>d({...l,nom:t.target.value}),className:"input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:[s("workers.prenom")," *"]}),e.jsx("input",{type:"text",value:l.prenom,onChange:t=>d({...l,prenom:t.target.value}),className:"input",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"label",children:[s("workers.cin")," *"]}),e.jsxs("div",{className:"relative",children:[e.jsx(yt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:l.cin,onChange:t=>d({...l,cin:t.target.value.toUpperCase()}),className:"input pl-10 uppercase",placeholder:"AB123456",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s("workers.fonction")}),e.jsx(je,{value:l.fonction,onChange:t=>d({...l,fonction:t}),suggestions:Q,placeholder:s("workers.fonctionPlaceholder"),icon:e.jsx(G,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s("workers.dateNaissance")}),e.jsx(he,{value:l.date_naissance,onChange:t=>d({...l,date_naissance:t}),placeholder:s("workers.selectDate")}),l.date_naissance&&(()=>{const t=new Date(l.date_naissance),r=new Date,n=r.getFullYear()-t.getFullYear(),c=r.getMonth()-t.getMonth();return(c<0||c===0&&r.getDate()<t.getDate()?n-1:n)<18?e.jsxs("p",{className:"text-xs text-red-600 dark:text-red-400 font-semibold mt-1 flex items-center gap-1",children:[e.jsx("span",{className:"inline-block w-2 h-2 bg-red-500 rounded-full animate-pulse"}),s("workers.minAge")]}):null})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s("workers.dateEntree")}),e.jsx(he,{value:l.date_entree,onChange:t=>d({...l,date_entree:t}),placeholder:s("workers.selectDate")})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s("workers.entreprise")}),e.jsx(je,{value:l.entreprise,onChange:t=>d({...l,entreprise:t}),suggestions:K,placeholder:s("workers.entreprisePlaceholder"),defaultValue:"SGTM",icon:e.jsx(bt,{className:"w-4 h-4"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"label",children:s("workers.projet")}),e.jsxs(P,{value:l.project_id,onChange:t=>d({...l,project_id:t.target.value}),children:[e.jsx("option",{value:"",children:s("common.select")}),A.map(t=>e.jsx("option",{value:t.id,children:fe(t)},t.id))]})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-gray-900 dark:text-white text-sm",children:s("workers.status")}),e.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:s("workers.statusHelp")})]}),e.jsx("button",{type:"button",onClick:()=>d({...l,is_active:!l.is_active}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${l.is_active?"bg-green-500":"bg-gray-300 dark:bg-gray-600"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${l.is_active?"translate-x-6":"translate-x-1"}`})})]}),!w&&e.jsx("div",{className:"p-3 bg-blue-50 dark:bg-blue-900/30 rounded-lg text-sm text-blue-700 dark:text-blue-300",children:e.jsx("p",{children:s("workers.cinInfo")})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:z,className:"btn-outline",children:s("common.cancel")}),e.jsxs("button",{type:"submit",disabled:re,className:"btn-primary flex items-center gap-2",children:[re&&e.jsx(J,{className:"w-4 h-4 animate-spin"}),s(w?"common.save":"workers.addWorker")]})]})]})}),e.jsx(ue,{isOpen:Re,onClose:()=>T(!1),title:s("workers.importTitle"),size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s("workers.importHelp")}),e.jsxs("button",{onClick:ie,className:"w-full btn-outline flex items-center justify-center gap-2",children:[e.jsx(V,{className:"w-4 h-4"}),s("workers.downloadTemplate")]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-300 dark:border-gray-600 rounded-lg p-6 text-center",children:[e.jsx("input",{ref:X,type:"file",accept:".xlsx,.xls,.csv",onChange:t=>L(t.target.files[0]),className:"hidden"}),S?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(V,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-sm font-medium",children:S.name}),e.jsx("button",{type:"button",onClick:()=>L(null),className:"p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded",children:e.jsx(kt,{className:"w-4 h-4"})})]}):e.jsx("button",{type:"button",onClick:()=>X.current?.click(),className:"text-hse-primary hover:underline",children:s("workers.selectFile")})]}),e.jsx("div",{className:"p-3 bg-amber-50 dark:bg-amber-900/20 rounded-lg text-sm text-amber-700 dark:text-amber-300",children:e.jsx("p",{children:s("workers.cinInfo")})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700",children:[e.jsx("button",{type:"button",onClick:()=>{T(!1),L(null)},className:"btn-outline",children:s("common.cancel")}),e.jsxs("button",{type:"button",onClick:Xe,disabled:!S||le,className:"btn-primary flex items-center gap-2",children:[le&&e.jsx(J,{className:"w-4 h-4 animate-spin"}),s("workers.import")]})]})]})}),e.jsx(ge,{isOpen:!!y,title:s("common.confirm"),message:y?s("workers.confirmDeactivate",{name:`${y.prenom} ${y.nom}`}):"",confirmLabel:s("workers.deactivate"),cancelLabel:s("common.cancel"),variant:"danger",onConfirm:Ve,onCancel:()=>H(null)}),e.jsx(ge,{isOpen:Be,title:s("common.confirm"),message:s("workers.confirmBulkDeactivate",{count:u.length}),confirmLabel:s("workers.bulkDeactivate"),cancelLabel:s("common.cancel"),variant:"danger",onConfirm:Ge,onCancel:()=>M(!1)})]})}export{Tt as default};
